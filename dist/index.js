"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var t=require("react"),s=e(t),i=e(require("axios"));class a{constructor(e){this.baseUrl=e,this.get=(e,t,s,i)=>this.fetch(e,t,i),this.post=(e,t,s,i)=>this.fetchWithBody("POST",e,t,s,i),this.delete=(e,t,s,i)=>this.fetchWithBody("DELETE",e,t,s,i),this.put=(e,t,s,i)=>this.fetchWithBody("PUT",e,t,s,i),this.absUrl=e=>this.baseUrl+e,this.getHeaders=e=>e?{Authorization:e,"Access-Control-Allow-Origin":"*"}:{},this.handleCancel=()=>null,this.fetch=(e,t,s={})=>i.get(this.absUrl(e),Object.assign(Object.assign({},s),{headers:Object.assign(Object.assign({},this.getHeaders(t)),"object"==typeof s.headers?s.headers:{})})).then(e=>e).catch(e=>{if(i.isCancel(e))return this.handleCancel();throw e}),this.fetchWithBody=(e,t,s,a={},c={})=>i(Object.assign(Object.assign({method:e,url:this.absUrl(t),data:a},c),{headers:Object.assign(Object.assign({},this.getHeaders(s)),"object"==typeof c.headers?c.headers:{})})).then(e=>e).catch(e=>{if(i.isCancel(e))return this.handleCancel();throw e})}}const c=t.createContext({authorizationToken:"",HttpService:new a(""),isProviderAdded:!1,cacheStore:{},updateCache:()=>{}});const n=e=>{try{return e.response&&e.response.data&&e.response.data.message||e.message}catch(t){return e}};exports.UseFetchProvider=e=>{const{children:i,baseUrl:n,authorizationToken:o}=e,r=new a(n),[d,h]=t.useState({});return s.createElement(c.Provider,{value:{authorizationToken:o,HttpService:r,isProviderAdded:!0,cacheStore:d,updateCache:(e,t)=>h(s=>Object.assign(Object.assign({},s),{[e]:t}))}},i)},exports.useFetch=e=>{"string"==typeof e&&(e={url:e});const{url:s,method:a="get",mockData:o,shouldDispatch:r,cancelable:d=!1,cache:h=!1,shouldUseAuthToken:l=!0,dependencies:u,before:f=(()=>{}),after:g=(()=>{}),options:b={}}=e,{authorizationToken:p,HttpService:j,isProviderAdded:v,cacheStore:O,updateCache:C}=t.useContext(c);if(!v)throw new Error("You must wrap your higher level(parent) component with UseFetchProvider, before using useFetch ðŸ˜¬");let y=(e=>{let t="";return t="function"==typeof e?e():e,t})(p);const k=u||[],P=!!o,w=l?y:null,F="get"===a&&h;let T=i.CancelToken.source();const U={data:o,status:{isPending:!1,isRejected:!1,isFulfilled:!1,isCached:!1,isMocked:P,err:""}},[m,S]=t.useState(U),x=e=>{return t=void 0,i=void 0,o=function*(){var t,i;if(f(),S({data:m.data?m.data:void 0,status:{isFulfilled:!1,isPending:!0,isRejected:!1,isCached:!1,isMocked:P,err:""}}),F){let e=O[s];e&&(e=Object.assign(Object.assign({},e),{status:Object.assign(Object.assign({},e.status),{isMocked:!1,isFulfilled:!0,isCached:!0})}),S(e),g(e))}null===(i=(t=j)[a])||void 0===i||i.call(t,s,w,e,Object.assign(Object.assign({},b),{cancelToken:T.token})).then(({data:e})=>{const t={data:e,status:{isFulfilled:!0,isPending:!1,isRejected:!1,isMocked:!1,isCached:!1,err:""}};S(t),g(t),F&&C(s,t)}).catch(e=>{const t={data:m.data,status:{isFulfilled:!1,isPending:!1,isCached:!1,isRejected:!0,isMocked:P,err:n(e)}};S(t),g(t)})},new((c=void 0)||(c=Promise))((function(e,s){function a(e){try{r(o.next(e))}catch(e){s(e)}}function n(e){try{r(o.throw(e))}catch(e){s(e)}}function r(t){t.done?e(t.value):new c((function(e){e(t.value)})).then(a,n)}r((o=o.apply(t,i||[])).next())}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var t,i,c,o};return t.useEffect(()=>{r?("function"==typeof r&&r()||"boolean"==typeof r&&r)&&x():void 0===r&&void 0!==u&&x()},[...k]),t.useEffect(()=>()=>{d&&T.cancel()},[]),[m,x,e=>{if(m.data){const t=e(m.data);(e=>{F&&C(s,{data:e,status:Object.assign(Object.assign({},U.status),{isCached:!0,isMocked:!1,isFulfilled:!0})})})(t),S({data:t,status:{isFulfilled:!0,isPending:!1,isRejected:!1,isMocked:!1,isCached:!1,err:""}})}}]};
